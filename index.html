<!DOCTYPE html>
<html>
<link rel="stylesheet" type="text/css" href="index.css">

<script src="index.js"></script>
<script src="chartConfig.js"></script>

<script src="./script/moment.js"></script>
<script src="./script/chart.js@2.8.0"></script>
<script src="./script/chartjs-plugin-streaming.js"></script>

<body>
    <div style="margin:auto; position: relative; width:1920px; height:80px">
        <div id="time-stamp"></div>
        <div id="raon-box"><img width="133.7666" height="33.8293" src="images/raon-white.svg"></a>
        </div>
        <div id="accelerator-control">CS</div>
    </div>

    <div id="grid-container">
        <!-- CPU -->
        <div class="grid-item">
            <p class="doughnutChartTitle">CPU</p>
            <div id="cpu-value" class="doughnutChartText">0</div>
            <div class="doughnutChartTextUnder">4Core</div>

            <div class="doughnutContain">
                <svg width="200" height="200" style="fill:none">
                    <circle class="doughnutBackground" cx="93.5" cy="93.5" r="93" />
                    <circle class="doughnutChart" id="cpu-chart" cx="93.5" cy="93.5" r="93"
                        style="--doughuntColor:#00ace6;" />
                </svg>
            </div>

            <div class="liveChartContain">
                <canvas id="cpu-graph" style="width:400px; height:200px"></canvas>
            </div>
        </div>

        <!-- Memory -->
        <div class="grid-item">
            <p class="doughnutChartTitle">Memory</p>
            <div id="memory-value" class="doughnutChartText">0</div>
            <div id="memory-total" class="doughnutChartTextUnder">32GB</div>

            <div class="doughnutContain">
                <svg width="200" height="200" style="fill:none">
                    <circle class="doughnutBackground" cx="93.5" cy="93.5" r="93" />
                    <circle class="doughnutChart" id="memory-chart" cx="93.5" cy="93.5" r="93"
                        style="--doughuntColor:#E4007F;" />
                </svg>
            </div>

            <div class="liveChartContain">
                <canvas id="memory-graph" style="width:400px; height:200px"></canvas>
            </div>
        </div>

        <!-- Disk -->
        <div class="grid-item">
            <p class="doughnutChartTitle">Disk</p>
            <div id="disk-value" class="doughnutChartText">0</div>
            <div id="disk-total" class="doughnutChartTextUnder">120GB</div>

            <div class="doughnutContain">
                <svg width="200" height="200" style="fill:none">
                    <circle class="doughnutBackground" cx="93.5" cy="93.5" r="93" />
                    <circle class="doughnutChart" id="disk-chart" cx="93.5" cy="93.5" r="93"
                        style="--doughuntColor:#13AE67;" />
                </svg>
            </div>

            <div class="liveChartContain">
                <canvas id="disk-graph" style="width:400px; height:200px"></canvas>
            </div>
        </div>

        <!-- Network -->
        <div class="grid-item">

        </div>

        <!-- Network Chart -->
        <div class="grid-item" style="grid-column: 2/4;">
            <div class="networkChartContain">
                <canvas id="network-graph" style="width: 820px; height: 300px;"></canvas>
            </div>
        </div>

    </div>
</body>

<script>
    window.onload = function () {
        document.getElementById('time-stamp').innerHTML = '2023-06-22 08:39:19';
        // var storageChartID = document.getElementById('storage-chart');
        // storageChartID.style.strokeDashoffset = '503';
        // simulation_network();

        var cpuChartID = document.getElementById('cpu-chart');
        cpuChartID.style.strokeDashoffset = '585';

        var memoryChartID = document.getElementById('memory-chart');
        memoryChartID.style.strokeDashoffset = '585';

        var memoryChartID = document.getElementById('disk-chart');
        memoryChartID.style.strokeDashoffset = '585';


        var cpuGraphContect = document.getElementById('cpu-graph').getContext('2d');
        window.cpuGraph = new Chart(cpuGraphContect, cpuChartConfig);

        var memoryGraphContect = document.getElementById('memory-graph').getContext('2d');
        window.memoryGraph = new Chart(memoryGraphContect, memoryChartConfig);

        var diskGraphContect = document.getElementById('disk-graph').getContext('2d');
        window.diskGraph = new Chart(diskGraphContect, diskChartConfig);

        setInterval(monitoringCPU, 5000);
        setInterval(monitoringMemory, 5000);
        setInterval(monitoringDisk, 10000);
        // setInterval(monitoringNetwork, 1000);

        // doughnutChartAnimation();

        // simulation_network();
        cpuChart();
    }

    // document.addEventListener('visibilitychange', function () {
    //     if (document.hidden) {
    //         // tab is now inactive
    //         // temporarily clear timer using clearInterval() / clearTimeout()
    //         clearInterval(storageIntervalID);
    //     } else {
    //         // tab is active again
    //         // restart timers
    //         // simulation_chart()
    //     }
    // });

    function simulation_network() {

        // SCL3, SCL2 Vlan 30, 20
        var scl32CharConfig = {
            // var color = Chart.helpers.color;
            type: 'line',
            data: {
                datasets: [{
                    label: 'Primary',
                    // backgroundColor: color(chartColors.blue).alpha(0.5).rgbString(),
                    borderColor: window.chartColors.red,
                    fill: false,
                    cubicInterpolationMode: 'monotone',
                    data: [],
                }, {
                    label: 'Secondary',
                    // backgroundColor: color(chartColors.blue).alpha(0.5).rgbString(),
                    borderColor: window.chartColors.blue,
                    fill: false,
                    cubicInterpolationMode: 'monotone',
                    data: [],
                }]
            },
            options: {
                title: {
                    display: true,
                    text: 'SCL3,2 Main Network Uplink'
                },
                legend: {
                    display: false
                },
                layout: {
                    padding: {
                        bottom: 10
                    }
                },
                responsive: false,
                scales: {
                    xAxes: [{
                        type: 'realtime',
                        realtime: {
                            duration: 60000,
                            refresh: 1000,
                            delay: 2000,
                            onRefresh: scl32DataOnRefresh
                        },
                        gridLines: {
                            display: false
                        }
                    }],
                    yAxes: [{
                        scaleLabel: {
                            display: true,
                            labelString: 'value'
                        },
                        gridLines: {
                            display: false
                        }
                    }]
                },
                tooltips: {
                    mode: 'nearest',
                    intersect: false
                },
                hover: {
                    mode: 'nearest',
                    intersect: false
                }
            }
        };


        var scl32ChartContext = document.getElementById('cpu-graph').getContext('2d');
        window.scl32Chart = new Chart(scl32ChartContext, scl32CharConfig);

        function scl32DataOnRefresh(chart) {
            var pValue = Math.floor(Math.random() * 10);
            // var pValue = networkSend / 1000000;
            pValue = pValue.toFixed(1);

            var sValue = Math.floor(Math.floor() * 10);
            // var sValue = networkReceive / 1000000;
            sValue = sValue.toFixed(1);

            chart.config.data.datasets[0].data.push({
                x: Date.now(),
                y: pValue
            });

            chart.config.data.datasets[1].data.push({
                x: Date.now(),
                y: sValue
            });
        }
    }
</script>

</html>